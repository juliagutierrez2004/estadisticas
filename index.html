<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scouting App - Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #eef2f3; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        #reloj { font-size: 50px; font-weight: bold; text-align: center; margin-bottom: 15px; color: #333; }
        .controles-tiempo { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; }
        
        .jugador-fila { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee; }
        .jugador-info { flex: 1; }
        .nombre { font-weight: bold; font-size: 18px; }
        .stats { font-size: 14px; color: #666; }
        
        button { border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-plus { background-color: #3498db; color: white; padding: 10px 15px; font-size: 18px; }
        .btn-minus { background-color: #ecf0f1; color: #7f8c8d; padding: 5px 10px; margin-left: 5px; }
        .btn-timer { padding: 10px 20px; background-color: #2ecc71; color: white; }
        .btn-pdf { background-color: #e74c3c; color: white; width: 100%; padding: 15px; margin-top: 20px; font-size: 16px; }
        
        /* Estilo para el PDF (invisible en la web) */
        #reporte-invisible { display: none; color: black; padding: 40px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>

<div class="container">
    <div id="reloj">00:00</div>
    <div class="controles-tiempo">
        <button id="btnPlay" class="btn-timer" onclick="toggleTiempo()">Iniciar</button>
        <button style="background:#95a5a6; color:white;" onclick="resetearTodo()">Reset</button>
    </div>

    <div id="lista-jugadores">
        </div>

    <button class="btn-pdf" onclick="generarReporte()">Finalizar Partido y Descargar PDF</button>
</div>

<div id="reporte-invisible">
    <h1 id="pdf-titulo">Reporte de Estadísticas</h1>
    <p id="pdf-fecha"></p>
    <table>
        <thead>
            <tr>
                <th>Jugador</th>
                <th>Puntos</th>
                <th>Faltas</th>
            </tr>
        </thead>
        <tbody id="pdf-tabla-cuerpo"></tbody>
    </table>
</div>

<script>
    let jugadores = [
        { id: 0, nombre: "Jugador 1", puntos: 0, faltas: 0 },
        { id: 1, nombre: "Jugador 2", puntos: 0, faltas: 0 },
        { id: 2, nombre: "Jugador 3", puntos: 0, faltas: 0 },
        { id: 3, nombre: "Jugador 4", puntos: 0, faltas: 0 },
        { id: 4, nombre: "Jugador 5", puntos: 0, faltas: 0 }
    ];

    let segundos = 0;
    let corriendo = false;
    let intervalo;

    window.onload = () => {
        const guardado = localStorage.getItem("stats_partido");
        if(guardado) {
            const data = JSON.parse(guardado);
            jugadores = data.jugadores;
            segundos = data.segundos;
            actualizarReloj();
        }
        dibujarJugadores();
    };

    function dibujarJugadores() {
        const lista = document.getElementById("lista-jugadores");
        lista.innerHTML = "";
        jugadores.forEach(j => {
            lista.innerHTML += `
                <div class="jugador-fila">
                    <div class="jugador-info">
                        <div class="nombre">${j.nombre}</div>
                        <div class="stats">Pts: ${j.puntos} | Faltas: ${j.faltas}</div>
                    </div>
                    <div>
                        <button class="btn-plus" onclick="modificar(${j.id}, 'puntos', 1)">+ Pts</button>
                        <button class="btn-plus" style="background:#f39c12" onclick="modificar(${j.id}, 'faltas', 1)">+ Falta</button>
                    </div>
                </div>
            `;
        });
        localStorage.setItem("stats_partido", JSON.stringify({jugadores, segundos}));
    }

    function modificar(id, campo, valor) {
        jugadores[id][campo] += valor;
        dibujarJugadores();
    }

    function toggleTiempo() {
        if(corriendo) {
            clearInterval(intervalo);
            document.getElementById("btnPlay").innerText = "Reanudar";
        } else {
            intervalo = setInterval(() => {
                segundos++;
                actualizarReloj();
                localStorage.setItem("stats_partido", JSON.stringify({jugadores, segundos}));
            }, 1000);
            document.getElementById("btnPlay").innerText = "Pausar";
        }
        corriendo = !corriendo;
    }

    function actualizarReloj() {
        let m = Math.floor(segundos / 60);
        let s = segundos % 60;
        document.getElementById("reloj").innerText = `${m < 10 ? '0' : ''}${m}:${s < 10 ? '0' : ''}${s}`;
    }

    function resetearTodo() {
        if(confirm("¿Borrar todo?")) {
            localStorage.clear();
            location.reload();
        }
    }

    function generarReporte() {
        const cuerpo = document.getElementById("pdf-tabla-cuerpo");
        document.getElementById("pdf-fecha").innerText = "Fecha: " + new Date().toLocaleString();
        cuerpo.innerHTML = "";
        
        jugadores.forEach(j => {
            cuerpo.innerHTML += `<tr><td>${j.nombre}</td><td>${j.puntos}</td><td>${j.faltas}</td></tr>`;
        });

        const element = document.getElementById('reporte-invisible');
        element.style.display = "block";
        
        html2pdf().from(element).save('Partido.pdf').then(() => {
            element.style.display = "none";
        });
    }
</script>
</body>
</html>
